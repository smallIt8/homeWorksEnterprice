name: Create PR for docs and README update

on:
  push:
    branches:
      - content-update

permissions:
  contents: write
  pull-requests: write

jobs:
  filter:
    runs-on: ubuntu-latest
    outputs:
      docs_changed: ${{ steps.filter.outputs.docs }}
    steps:
      - uses: actions/checkout@v3
      - uses: dorny/paths-filter@v3
        id: filter
        with:
          filters: |
            docs:
              - 'docs/**'
              - 'README.md'
              - '.github/**'

  create-pull-request:
    needs: filter
    runs-on: ubuntu-latest
    if: needs.filter.outputs.docs_changed == 'true'
    steps:
      - uses: actions/checkout@v3
        with:
          ref: content-update

      - name: Create or update Pull Request to main
        uses: peter-evans/create-pull-request@v5
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          commit-message: 'Update docs and README.md'
          branch: auto/docs-update  # üü¢ –Ω–æ–≤–∞—è –≤–µ—Ç–∫–∞ –¥–ª—è PR
          base: main
          title: 'Auto-update docs and README.md'
          body: |
            –≠—Ç–æ—Ç PR –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç—Å—è/–æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –ø–∞–ø–∫–∞—Ö docs, README.md –∏ .github –∏–∑ content-update –≤ main.
          labels: docs, auto-generated
          draft: false
